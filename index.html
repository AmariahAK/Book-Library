<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Library</title>
    
    <!-- Link to external CSS file -->
    <link rel="stylesheet" href="style.css">

    <!-- Include Axios for HTTP requests -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <style>
        /* CSS for button spacing and dropdowns */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background-color: #483d8b;
            color: #fff;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #6a5acd;
            padding: 10px;
        }

        nav button {
            margin-right: 10px;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }

        #searchInput {
            width: 200px;
            padding: 8px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        /* Form styles */
        form {
            margin-top: 20px;
        }

        label {
            font-weight: bold;
        }

        input[type="text"],
        textarea,
        select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }

        button {
            padding: 10px 20px;
            background-color: #6a5acd;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        button:hover {
            background-color: #836fff;
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header>
        <h1>Book Library</h1>
        <input type="text" id="searchInput" placeholder="Search...">
        <button onclick="searchBooks()">Search</button>
    </header>

    <!-- Navigation menu -->
    <nav>
        <!-- Genres dropdown -->
        <div>
            <button onclick="toggleDropdown('genreDropdown')">Genres</button>
            <div id="genreDropdown" class="dropdown-content">
                <a href="#" onclick="displayCategory('kids')">Kids Books</a>
                <a href="#" onclick="displayCategory('musical')">Musicals</a>
                <a href="#" onclick="displayCategory('action')">Action</a>
                <a href="#" onclick="displayCategory('fantasy')">Fantasy</a>
                <a href="#" onclick="displayCategory('horror')">Horror</a>
                <a href="#" onclick="displayCategory('psychological')">Psychological</a>
                <a href="#" onclick="displayCategory('thriller')">Thriller</a>
                <a href="#" onclick="displayCategory('romance')">Romance</a>
                <a href="#" onclick="displayCategory('self-help')">Self Help</a>
                <a href="#" onclick="displayCategory('science-fiction')">Science Fiction</a>
                <a href="#" onclick="displayCategory('mystery')">Mystery</a>
                <a href="#" onclick="displayCategory('historical')">Historical</a>
                <a href="#" onclick="displayCategory('biography')">Biography</a>
                <a href="#" onclick="displayCategory('comics')">Comics</a>
            </div>
        </div>

        <!-- Add Book dropdown -->
        <div>
            <button onclick="toggleDropdown('addBookDropdown')">Add Book</button>
            <div id="addBookDropdown" class="dropdown-content">
                <form id="addBookForm" onsubmit="addNewBook(event)">
                    <label for="titleInput">Title:</label>
                    <input type="text" id="titleInput" required><br>
                    <label for="descriptionInput">Description:</label>
                    <textarea id="descriptionInput" required></textarea><br>
                    <label for="categorySelect">Category:</label>
                    <select id="categorySelect" required>
                        <option value="kids">Kids</option>
                        <option value="musical">Musical</option>
                        <option value="action">Action</option>
                        <option value="fantasy">Fantasy</option>
                        <option value="horror">Horror</option>
                        <option value="psychological">Psychological</option>
                        <option value="thriller">Thriller</option>
                        <option value="romance">Romance</option>
                        <option value="self-help">Self Help</option>
                        <option value="science-fiction">Science Fiction</option>
                        <option value="mystery">Mystery</option>
                        <option value="historical">Historical</option>
                        <option value="biography">Biography</option>
                        <option value="comics">Comics</option>
                    </select><br>
                    <label for="imageInput">Image URL:</label>
                    <input type="text" id="imageInput" required><br>
                    <button type="submit">Add Book</button>
                </form>
            </div>
        </div>
    </nav>

    <!-- Main content area -->
    <div class="container">
        <!-- Book container -->
        <div id="book-container"></div>
    </div>

    <script>
        const BASE_URL = 'https://www.googleapis.com/books/v1';
        const API_KEY = 'AIzaSyDREw30aFfJweL9yMTjVPcSN6-xdmqkoNE';

        // Function to toggle dropdown visibility
        function toggleDropdown(dropdownId) {
            const dropdown = document.getElementById(dropdownId);
            dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
        }

        // Function to search books using Google Books API
        async function searchBooks() {
            const searchTerm = document.getElementById('searchInput').value;
            const encodedSearchTerm = encodeURIComponent(searchTerm);
            const searchUrl = `${BASE_URL}/volumes?q=${encodedSearchTerm}&key=${API_KEY}`;

            try {
                const response = await axios.get(searchUrl);
                const { items } = response.data;
                displayBooks(items);
            } catch (error) {
                console.error('Error searching books:', error);
                alert('Failed to search books. Please try again.');
            }
        }

        // Function to display books based on category
        async function displayCategory(category) {
            const apiUrl = `${BASE_URL}/volumes?q=subject:${category}&key=${API_KEY}`;

            try {
                const response = await axios.get(apiUrl);
                const { items } = response.data;
                displayBooks(items);
            } catch (error) {
                console.error(`Error displaying books for category '${category}':`, error);
                alert(`Failed to display books for category '${category}'. Please try again.`);
            }
        }

        // Function to display books in the container
        function displayBooks(books) {
            const booksContainer = document.getElementById('book-container');
            if (!booksContainer) return;

            booksContainer.innerHTML = '';

            books.forEach(book => {
                const bookElement = createBookElement(book);
                booksContainer.appendChild(bookElement);
            });
        }

        // Function to create book element
        function createBookElement(book) {
            const { volumeInfo } = book;
            const { title, description, categories, imageLinks } = volumeInfo;
            const imageUrl = imageLinks ? imageLinks.thumbnail : 'https://via.placeholder.com/150';

            const bookElement = document.createElement('div');
            bookElement.classList.add('book');

            const bookTitle = document.createElement('h3');
            bookTitle.textContent = title || 'Untitled';
            bookElement.appendChild(bookTitle);

            const bookDescription = document.createElement('p');
            bookDescription.textContent = description || 'No description available';
            bookElement.appendChild(bookDescription);

            const bookGenre = document.createElement('p');
            bookGenre.textContent = `Genre: ${categories ? categories.join(', ') : 'Unknown'}`;
            bookElement.appendChild(bookGenre);

            const img = document.createElement('img');
            img.src = imageUrl;
            img.alt = title || 'Book Image';
            img.style.width = '150px';
            bookElement.appendChild(img);

            return bookElement;
        }

        // Function to add a new book using Google Books API
        async function addNewBook(event) {
            event.preventDefault();

            const title = document.getElementById('titleInput').value;
            const description = document.getElementById('descriptionInput').value;
            const category = document.getElementById('categorySelect').value;
            const imageUrl = document.getElementById('imageInput').value;

            const newBook = {
                volumeInfo: {
                    title,
                    description,
                    categories: [category],
                    imageLinks: { thumbnail: imageUrl }
                }
            };

            try {
                const response = await axios.post(`${BASE_URL}/volumes?key=${API_KEY}`, newBook);
                console.log('New book added:', response.data);
                alert('Book added successfully!');
                // Refresh books display or show success message
            } catch (error) {
                console.error('Error adding new book:', error);
                alert('Failed to add new book. Please try again.');
            }
        }
    </script>

</body>
</html>
